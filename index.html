async function loadFromSheet(sheetId){
  soalData = [];
  try{
    const url = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json`;
    const res = await fetch(url);
    const text = await res.text();

    const clean = text
      .replace(/\/\*[\s\S]*?\*\//g, '') 
      .replace(/^[\s\S]*?\(/, '')  
      .replace(/\);?$/, '');           

    const json = JSON.parse(clean);

    if(!json.table || !json.table.rows){
      throw new Error("Format sheet tidak sesuai.");
    }

    json.table.rows.forEach(r=>{
      const c = r.c || [];
      const s = {
        soal: c[0]?.v ? String(c[0].v) : "",
        A:    c[1]?.v ? String(c[1].v) : "",
        B:    c[2]?.v ? String(c[2].v) : "",
        C:    c[3]?.v ? String(c[3].v) : "",
        D:    c[4]?.v ? String(c[4].v) : "",
        kunci: c[5]?.v ? String(c[5].v).toUpperCase() : "",
      };
      if (s.soal) soalData.push(s);
    });

    if(soalData.length === 0){
      alert("Sheet kosong. Pastikan kolom: soal | A | B | C | D | kunci");
      return false;
    }

    return true;

  }catch(err){
    console.error(err);
    alert('Gagal memuat sheet. Pastikan ID benar dan sheet dipublikasi (File â†’ Publish to web).');
    return false;
  }
}
